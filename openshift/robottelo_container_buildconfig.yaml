apiVersion: v1
kind: List
items:
- kind: ImageStream
  apiVersion: image.openshift.io/v1
  metadata:
    name: robottelo-upstream
  spec:
    tags:
    - name: latest
      from:
        kind: DockerImage
        name: quay.io/satelliteqe/robottelo:latest
      importPolicy:
        scheduled: true
      referencePolicy:
        type: Source
    - name: 6.9.z
      from:
        kind: DockerImage
        name: quay.io/satelliteqe/robottelo:6.9.z
      importPolicy:
        scheduled: true
      referencePolicy:
        type: Source

- kind: ImageStream
  apiVersion: image.openshift.io/v1
  metadata:
    labels:
      name: robottelo-container
    name: robottelo-container
  spec:
    lookupPolicy:
      local: true

- kind: BuildConfig
  apiVersion: build.openshift.io/v1
  metadata:
    creationTimestamp:
    labels:
      name: robottelo-container
    name: robottelo-container
  spec:
    output:
      to:
        kind: ImageStreamTag
        name: robottelo-container:latest
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: https://gitlab.sat.engineering.redhat.com/satelliteqe/satelliteqe-jenkins.git
        ref: master
      type: Git
      contextDir: openshift
    strategy:
      # TODO OCP Builder does not have the right CA to clone public gitlab.
      # TODO Look into making satqe jenkins repo private and using deploy tokens
      dockerStrategy:
        dockerfilePath: robottelo/Dockerfile
        env:
        - name: GIT_SSL_NO_VERIFY
          value: 'true'
      type: Docker
    triggers:
    - type: ImageChange
      imageChange:
        automatic: true
        from:
          kind: ImageStreamTag
          name: robottelo-upstream:latest
    - type: ConfigChange
    postCommit:
      script: curl -v https://satqe-jenkins-csb-satellite-qe.apps.ocp4.prod.psi.redhat.com/generic-webhook-trigger/invoke?token=polariontestcaseupload
  status:
    lastVersion: 0

- kind: BuildConfig
  apiVersion: build.openshift.io/v1
  metadata:
    creationTimestamp:
    labels:
      name: robottelo-container-6.9.z
    name: robottelo-container-6.9.z
  spec:
    output:
      to:
        kind: ImageStreamTag
        name: robottelo-container:6.9.z
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: https://gitlab.sat.engineering.redhat.com/satelliteqe/satelliteqe-jenkins.git
        ref: master
      type: Git
      contextDir: openshift
    strategy:
      # TODO OCP Builder does not have the right CA to clone public gitlab.
      # TODO Look into making satqe jenkins repo private and using deploy tokens
      dockerStrategy:
        dockerfilePath: robottelo/Dockerfile
        env:
        - name: GIT_SSL_NO_VERIFY
          value: 'true'
        - name: ROBOTTELO_BRANCH
          value: 6.9.z
      type: Docker
    triggers:
    - type: ImageChange
      imageChange:
        automatic: true
        from:
          kind: ImageStreamTag
          name: robottelo-upstream:6.9.z
    - type: ConfigChange
  status:
    lastVersion: 0
